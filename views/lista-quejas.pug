extends layout

block content
  .container.mt-4
    h2.text-center.mb-4 Lista de Quejas
    table.table.table-hover.align-middle
      thead.table-dark
        tr
          th ID
          th Entidad
          th Descripción
          th Estado
          th Acciones
      tbody
        each queja in quejas
          tr
            td #{queja.id}
            td #{queja.Entity.nombre}
            td #{queja.descripcion}
            td
              span.badge(
                class= queja.estado === 'pendiente' ? 'bg-warning text-dark' :
                       queja.estado === 'en proceso' ? 'bg-info text-dark' :
                       'bg-success'
              ) #{queja.estado}
            td
              div.dropdown
                button.btn.btn-secondary.btn-sm.no-caret(
                  type='button',
                  id='dropdownMenu' + queja.id,
                  data-bs-toggle='dropdown',
                  aria-expanded='false'
                ) ...
                ul.dropdown-menu(aria-labelledby='dropdownMenu' + queja.id)
                  li
                    a.dropdown-item.btn-view(href=`/complaint/${queja.id}`) Ver comentario
                  li
                    button.dropdown-item.btn-change-state(
                      data-id=queja.id,
                      data-estado=queja.estado
                    ) Cambiar estado
                  li
                    button.dropdown-item.btn-delete(data-id=queja.id) Eliminar

    // Paginación (si aplica)
    nav.mt-4
      ul.pagination.justify-content-center#pagination

  // Modal de cambio de estado
  div.modal.fade#modalCambiarEstado(tabindex='-1', aria-labelledby='modalCambiarEstadoLabel', aria-hidden='true')
    .modal-dialog.modal-dialog-centered
      .modal-content
        .modal-header.bg-primary.text-white
          h5.modal-title#modalCambiarEstadoLabel Cambiar estado de la queja
          button.btn-close(type='button', data-bs-dismiss='modal', aria-label='Close')
        .modal-body
          p.mb-2 Selecciona el nuevo estado para esta queja:
          select.form-select#nuevoEstado
            option(value='pendiente') Pendiente
            option(value='en proceso') En proceso
            option(value='resuelta') Resuelta
        .modal-footer
          button.btn.btn-secondary(type='button', data-bs-dismiss='modal') Cancelar
          button.btn.btn-success#btnGuardarEstado(type='button')
            i.bi.bi-save.me-1
            | Guardar cambios
